# Generated by Ansible. DO NOT EDIT MANUALLY
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# DATABASE

CONNECTION_DRIVER="{{ munkireport.database.driver }}"
CONNECTION_HOST="{{ munkireport.database.host }}"
CONNECTION_PORT={{ munkireport.database.port }}
CONNECTION_DATABASE="{{ munkireport.database.name }}"
CONNECTION_USERNAME="{{ munkireport.database.user }}"
CONNECTION_PASSWORD="{{ munkireport.database.password }}"
CONNECTION_CHARSET="utf8mb4"
CONNECTION_COLLATION="utf8mb4_unicode_ci"
CONNECTION_STRICT=TRUE
CONNECTION_ENGINE="{{ munkireport.database.engine }}"


# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# Web Settings

INDEX_PAGE="index.php?"
URI_PROTOCOL="AUTO"
SITENAME="{{ munkireport.site.name }}"
AUTH_SECURE=TRUE

## UI
VNC_LINK="vnc://%s:5900"
SSH_LINK="ssh://adminuser@%s"
APPS_TO_TRACK="{{ munkireport.apps_to_track | default('') | join(',') }}"

{% if munkireport.http_proxy is defined %}
## Proxy
PROXY_SERVER="{{ munkireport.http_proxy.server }}"
PROXY_PORT="{{ munkireport.http_proxy.port }}"
{% endif %}

{% if munkireport.recaptcha is defined %}
## RECAPTCHA
RECAPTCHA_LOGIN_PUBLIC_KEY="{{ munkireport.recaptcha.public_key }}"
RECAPTCHA_LOGIN_PRIVATE_KEY="{{ munkireport.recaptcha.private_key }}"
{% endif %}


# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# AUTHENTICATION

ENABLE_BUSINESS_UNITS={{ "TRUE" if munkireport.auth.business_units | default("FALSE") }}

AUTH_METHODS="{{ munkireport.auth.methods | join(',') }}"

## Active Directory (LDAP)
{% if munkireport.auth.ad.enabled %}
AUTH_AD_HOSTS="{{ munkireport.auth.ad.hosts }}"
AUTH_AD_BASE_DN="{{ munkireport.auth.ad.base_dn }}"
AUTH_AD_SCHEMA={{ munkireport.auth.ad.schema }}
AUTH_AD_ACCOUNT_PREFIX="{{ munkireport.auth.ad.account_prefix }}"
AUTH_AD_ACCOUNT_SUFFIX="{{ munkireport.auth.ad.account_suffix }}"
AUTH_AD_USERNAME="{{ munkireport.auth.ad.username }}"
AUTH_AD_PASSWORD="{{ munkireport.auth.ad.password }}"
AUTH_AD_PORT={{ munkireport.auth.ad.port }}
AUTH_AD_USE_TLS={{ "TRUE" if munkireport.auth.ad.tls else "FALSE" }}
AUTH_AD_ALLOWED_USERS="{{ munkireport.auth.ad.allowed_users | join(',') }}"
{% endif %}

## Admin users
{% if munkireport.auth.admin_users is defined %}
ROLES_ADMIN="{{ munkireport.auth.admin_users | join(',') }}"
{% endif %}


# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# Modules

MODULES="{{ munkireport.modules.enabled | default('') | join(',') }}"
MODULE_SEARCH_PATHS="{{ munkireport.modules.search_paths | default('') | join(',') }}"
HIDE_INACTIVE_MODULES={{ "TRUE" if munkireport.modules.hide_inactive | default("FALSE") }}

{% if munkireport.modules.raw_config is defined %}
## Module config
{{ munkireport.modules.raw_config }}
{% endif %}


# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# Client

## Client CURL optis
CURL_CMD="/usr/bin/curl, --fail, --silent, --show-error"

## Allow secrets (machine groups)
{% set client_passphrases = [] %}
{% for customer in munkireport.customers | default([]) %}
{%   for group in customer.munkireport.groups | default([]) %}
{%     set client_passphrases = client_passphrases.append(group.uuid) %}
{%   endfor %}
{% endfor %}
{% if munkireport.client_passphrases is defined %}
CLIENT_PASSPHRASES="{{ munkireport.client_passphrases | join(',') }}"
{% elif munkireport.customers is defined %}
CLIENT_PASSPHRASES="{{ client_passphrases | join(',') }}"
{% endif %}
